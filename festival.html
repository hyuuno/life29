<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>元旦快乐 · Life29</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Noto+Serif+SC:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Serif SC', serif;
            overflow: hidden;
            cursor: crosshair;
        }
        
        .festival-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
        }
        
        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('images/festival-bg.jpg');
            background-size: cover;
            background-position: center;
            filter: brightness(0.7);
        }
        
        #fireworksCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3), transparent);
        }
        
        .logo {
            display: flex;
            align-items: baseline;
            gap: 2px;
            text-decoration: none;
        }
        .logo-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.75rem;
            font-weight: 300;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .logo-number {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1rem;
            color: #ffb7c5;
            margin-left: 2px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .nav {
            display: flex;
            gap: 8px;
        }
        .nav-link {
            font-size: 0.875rem;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        .nav-link:hover {
            color: #fff;
            background: rgba(255,255,255,0.1);
        }
        .nav-link.active {
            color: #fff;
            background: rgba(255,255,255,0.15);
        }
        
        .greeting {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 50;
            pointer-events: none;
        }
        
        .greeting-year {
            font-family: 'Cormorant Garamond', serif;
            font-size: 8rem;
            font-weight: 300;
            color: #fff;
            text-shadow: 0 4px 30px rgba(255,180,200,0.5);
            line-height: 1;
            opacity: 0.9;
            animation: glow 3s ease-in-out infinite;
        }
        
        .greeting-text {
            font-size: 2rem;
            font-weight: 300;
            color: #fff;
            text-shadow: 0 2px 20px rgba(0,0,0,0.5);
            margin-top: 10px;
            letter-spacing: 0.3em;
            opacity: 0.9;
        }
        
        .greeting-sub {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
            margin-top: 20px;
            letter-spacing: 0.1em;
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 4px 30px rgba(255,180,200,0.5); }
            50% { text-shadow: 0 4px 50px rgba(255,200,150,0.8), 0 0 80px rgba(255,150,100,0.3); }
        }
        
        .hint {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255,255,255,0.6);
            font-size: 0.8rem;
            letter-spacing: 0.1em;
            z-index: 50;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* 音效开关 */
        .sound-toggle {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: all 0.3s;
        }
        .sound-toggle:hover {
            background: rgba(255,255,255,0.2);
        }
        .sound-toggle.muted svg {
            opacity: 0.4;
        }
    </style>
</head>
<body>
    <div class="festival-container">
        <div class="background"></div>
        <canvas id="fireworksCanvas"></canvas>
    </div>
    
    <header class="header">
        <a href="index.html" class="logo">
            <span class="logo-text">Life</span>
            <span class="logo-number">29</span>
        </a>
        <nav class="nav">
            <a href="index.html" class="nav-link">地球</a>
            <a href="schedule.html" class="nav-link">做咩</a>
            <a href="music.html" class="nav-link">Music</a>
            <a href="festival.html" class="nav-link active">节日</a>
        </nav>
    </header>
    
    <div class="greeting">
        <div class="greeting-year">2025</div>
        <div class="greeting-text">元旦快乐</div>
        <div class="greeting-sub">Happy New Year</div>
    </div>
    
    <div class="hint">点击屏幕放烟花 ✨</div>
    
    <button class="sound-toggle" id="soundToggle" title="音效开关">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
        </svg>
    </button>

    <script>
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        
        // 设置画布大小
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // 烟花粒子类
        class Particle {
            constructor(x, y, color, velocity, size, type) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.velocity = velocity;
                this.size = size;
                this.type = type; // 'circle', 'star', 'heart', 'spark'
                this.alpha = 1;
                this.decay = Math.random() * 0.015 + 0.01;
                this.gravity = 0.05;
                this.friction = 0.98;
                this.trail = [];
                this.maxTrail = type === 'spark' ? 8 : 4;
            }
            
            update() {
                // 记录轨迹
                this.trail.push({ x: this.x, y: this.y, alpha: this.alpha });
                if (this.trail.length > this.maxTrail) {
                    this.trail.shift();
                }
                
                this.velocity.x *= this.friction;
                this.velocity.y *= this.friction;
                this.velocity.y += this.gravity;
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= this.decay;
            }
            
            draw() {
                // 绘制轨迹
                this.trail.forEach((point, index) => {
                    const trailAlpha = (index / this.trail.length) * this.alpha * 0.5;
                    ctx.save();
                    ctx.globalAlpha = trailAlpha;
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(point.x, point.y, this.size * 0.5, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                });
                
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.color;
                
                switch (this.type) {
                    case 'star':
                        this.drawStar(this.x, this.y, 5, this.size, this.size * 0.5);
                        break;
                    case 'heart':
                        this.drawHeart(this.x, this.y, this.size);
                        break;
                    case 'spark':
                        this.drawSpark(this.x, this.y, this.size);
                        break;
                    default:
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                        ctx.fill();
                }
                
                ctx.restore();
            }
            
            drawStar(cx, cy, spikes, outerRadius, innerRadius) {
                let rot = Math.PI / 2 * 3;
                let step = Math.PI / spikes;
                
                ctx.beginPath();
                ctx.moveTo(cx, cy - outerRadius);
                
                for (let i = 0; i < spikes; i++) {
                    let x = cx + Math.cos(rot) * outerRadius;
                    let y = cy + Math.sin(rot) * outerRadius;
                    ctx.lineTo(x, y);
                    rot += step;
                    
                    x = cx + Math.cos(rot) * innerRadius;
                    y = cy + Math.sin(rot) * innerRadius;
                    ctx.lineTo(x, y);
                    rot += step;
                }
                
                ctx.lineTo(cx, cy - outerRadius);
                ctx.closePath();
                ctx.fill();
            }
            
            drawHeart(x, y, size) {
                ctx.beginPath();
                ctx.moveTo(x, y + size * 0.3);
                ctx.bezierCurveTo(x, y, x - size, y, x - size, y + size * 0.6);
                ctx.bezierCurveTo(x - size, y + size, x, y + size * 1.2, x, y + size * 1.5);
                ctx.bezierCurveTo(x, y + size * 1.2, x + size, y + size, x + size, y + size * 0.6);
                ctx.bezierCurveTo(x + size, y, x, y, x, y + size * 0.3);
                ctx.fill();
            }
            
            drawSpark(x, y, size) {
                ctx.beginPath();
                ctx.moveTo(x - size, y);
                ctx.lineTo(x + size, y);
                ctx.moveTo(x, y - size);
                ctx.lineTo(x, y + size);
                ctx.strokeStyle = this.color;
                ctx.lineWidth = size * 0.3;
                ctx.stroke();
            }
        }
        
        // 烟花火箭类
        class Rocket {
            constructor(startX, startY, targetX, targetY, color) {
                this.x = startX;
                this.y = startY;
                this.targetX = targetX;
                this.targetY = targetY;
                this.color = color;
                
                const angle = Math.atan2(targetY - startY, targetX - startX);
                const distance = Math.sqrt(Math.pow(targetX - startX, 2) + Math.pow(targetY - startY, 2));
                const speed = Math.min(distance * 0.03, 15);
                
                this.velocity = {
                    x: Math.cos(angle) * speed,
                    y: Math.sin(angle) * speed
                };
                
                this.trail = [];
                this.distanceTraveled = 0;
                this.targetDistance = distance;
                this.exploded = false;
            }
            
            update() {
                this.trail.push({ x: this.x, y: this.y });
                if (this.trail.length > 15) {
                    this.trail.shift();
                }
                
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                
                this.distanceTraveled += Math.sqrt(
                    Math.pow(this.velocity.x, 2) + Math.pow(this.velocity.y, 2)
                );
                
                // 到达目标位置
                if (this.distanceTraveled >= this.targetDistance * 0.95) {
                    this.exploded = true;
                }
            }
            
            draw() {
                // 绘制轨迹
                ctx.beginPath();
                this.trail.forEach((point, index) => {
                    const alpha = index / this.trail.length;
                    ctx.strokeStyle = `rgba(255, 200, 150, ${alpha * 0.8})`;
                    ctx.lineWidth = 2;
                    if (index === 0) {
                        ctx.moveTo(point.x, point.y);
                    } else {
                        ctx.lineTo(point.x, point.y);
                    }
                });
                ctx.stroke();
                
                // 绘制火箭头
                ctx.save();
                ctx.fillStyle = '#fff';
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }
        
        // 烟花颜色方案
        const colorSchemes = [
            // 金色系
            ['#FFD700', '#FFA500', '#FF8C00', '#FFEC8B', '#FFE4B5'],
            // 红色系
            ['#FF6B6B', '#FF4757', '#FF3838', '#FF6348', '#FF7675'],
            // 粉色系
            ['#FF69B4', '#FF1493', '#FFB6C1', '#FFC0CB', '#FF82AB'],
            // 蓝色系
            ['#00CED1', '#00BFFF', '#1E90FF', '#87CEEB', '#ADD8E6'],
            // 紫色系
            ['#9B59B6', '#8E44AD', '#DDA0DD', '#DA70D6', '#BA55D3'],
            // 绿色系
            ['#2ECC71', '#27AE60', '#90EE90', '#98FB98', '#00FA9A'],
            // 彩虹
            ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#8B00FF'],
            // 白金
            ['#FFFFFF', '#F5F5F5', '#FFFAFA', '#F0FFFF', '#F8F8FF']
        ];
        
        // 烟花形状
        const shapes = ['circle', 'star', 'heart', 'spark', 'circle', 'circle'];
        
        let rockets = [];
        let particles = [];
        let autoFireworkInterval = null;
        
        // 创建烟花爆炸
        function createExplosion(x, y, colorScheme) {
            const colors = colorScheme || colorSchemes[Math.floor(Math.random() * colorSchemes.length)];
            const particleCount = 80 + Math.floor(Math.random() * 60);
            const shape = shapes[Math.floor(Math.random() * shapes.length)];
            
            // 主爆炸
            for (let i = 0; i < particleCount; i++) {
                const angle = (Math.PI * 2 / particleCount) * i + Math.random() * 0.2;
                const speed = Math.random() * 6 + 2;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                particles.push(new Particle(
                    x, y,
                    color,
                    { x: Math.cos(angle) * speed, y: Math.sin(angle) * speed },
                    Math.random() * 2 + 1,
                    shape
                ));
            }
            
            // 内圈小粒子
            for (let i = 0; i < 30; i++) {
                const angle = Math.random() * Math.PI * 2;
                const speed = Math.random() * 3 + 1;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                particles.push(new Particle(
                    x, y,
                    color,
                    { x: Math.cos(angle) * speed, y: Math.sin(angle) * speed },
                    Math.random() * 1.5 + 0.5,
                    'spark'
                ));
            }
            
            // 闪光效果
            createFlash(x, y, colors[0]);
        }
        
        // 创建闪光
        function createFlash(x, y, color) {
            ctx.save();
            const gradient = ctx.createRadialGradient(x, y, 0, x, y, 100);
            gradient.addColorStop(0, color);
            gradient.addColorStop(0.5, `${color}44`);
            gradient.addColorStop(1, 'transparent');
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(x, y, 100, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }
        
        // 发射烟花
        function launchFirework(targetX, targetY) {
            const startX = targetX + (Math.random() - 0.5) * 100;
            const startY = canvas.height + 50;
            const colorScheme = colorSchemes[Math.floor(Math.random() * colorSchemes.length)];
            
            rockets.push(new Rocket(startX, startY, targetX, targetY, colorScheme[0]));
            
            // 播放音效
            playSound();
        }
        
        // 音效
        let soundEnabled = true;
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound() {
            if (!soundEnabled) return;
            
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(400 + Math.random() * 200, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(100, audioContext.currentTime + 0.3);
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                console.log('Audio not supported');
            }
        }
        
        // 音效开关
        document.getElementById('soundToggle').addEventListener('click', () => {
            soundEnabled = !soundEnabled;
            document.getElementById('soundToggle').classList.toggle('muted', !soundEnabled);
        });
        
        // 点击发射烟花
        canvas.addEventListener('click', (e) => {
            launchFirework(e.clientX, e.clientY);
        });
        
        // 触摸支持
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            launchFirework(touch.clientX, touch.clientY);
        });
        
        // 自动烟花
        function startAutoFireworks() {
            autoFireworkInterval = setInterval(() => {
                if (Math.random() < 0.3) {
                    const x = Math.random() * canvas.width * 0.8 + canvas.width * 0.1;
                    const y = Math.random() * canvas.height * 0.5 + canvas.height * 0.1;
                    launchFirework(x, y);
                }
            }, 2000);
        }
        
        // 开始时发射几个烟花
        setTimeout(() => {
            launchFirework(canvas.width * 0.3, canvas.height * 0.3);
        }, 500);
        setTimeout(() => {
            launchFirework(canvas.width * 0.7, canvas.height * 0.4);
        }, 1200);
        setTimeout(() => {
            launchFirework(canvas.width * 0.5, canvas.height * 0.25);
        }, 2000);
        
        // 动画循环
        function animate() {
            // 半透明黑色覆盖，产生拖尾效果
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 更新和绘制火箭
            rockets = rockets.filter(rocket => {
                rocket.update();
                rocket.draw();
                
                if (rocket.exploded) {
                    createExplosion(rocket.x, rocket.y);
                    return false;
                }
                return true;
            });
            
            // 更新和绘制粒子
            particles = particles.filter(particle => {
                particle.update();
                particle.draw();
                return particle.alpha > 0.01;
            });
            
            requestAnimationFrame(animate);
        }
        
        animate();
        startAutoFireworks();
    </script>
</body>
</html>
